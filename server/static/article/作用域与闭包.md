# 作用域与闭包

### js中有两种作用域

全局作用域

- 在全局作用域中声明的变量，会被提升到脚本块顶部，并成为全局对象window的属性

函数作用域

- 在函数作用域中声明的变量，会被提升到函数的顶部。

判断一个属性是否在一个对象里面可以用 in 如： a in obj

提倡把功能封装在函数里面，但是函数也会成为全局对象的属性，当不想函数污染全局对象，则把函数声明改为函数表达式，当函数成为一个表达式的时候，它既不会提升，也不会污染全局对象。

- 将函数变成一个表达式方式之一，将函数用小括号括起来，但是这样它返回的是函数本身，只能后面跟小括号立即执行，不然后面就不能通过函数名来调用了。通常将这类函数称为立即执行函数（IIFE）。由于后续不能通过函数名来调用这个函数，所以函数名也没有意义，所以可以省略不写。

由于大多数情况下，函数表达式的函数名没有实际意义，因此可以省略不写。

没有函数名的函数称为匿名函数



### 作用域中可以使用的变量

关键词：作用域链

实际用途：有时候，某个函数比较复杂，在编写过程中，可能需要另外一些函数来辅助它完成一些功能，而这些函数仅仅只能被这个函数所使用，不会再其他位置被调用，则可以将这些函数声明到这个函数的内部。

## 作用域链

有一个不可以访问的属性[[scope]]
函数声明时的作用域[[scope]],

```js
var  a = 1;
function A (){
    console.log(a);  //预编译阶段就已经决定A函数的作用域链是A0->GO
}
function Special(){
    var a = 5;
    var B = A;
    B();
}
Special();   //输出 1
//主要是预编译，A已经保存了a
```

[[scope]]是一个对象的属性，函数也是一个对象，但是不可访问，只共js引擎存取，[[scope]]里面存储了执行期上下文，分为函数定义和函数执行两个步骤，函数定义时创建go，执行是创建ao，如果是函数里面定义的函数，那么他的[[scope]]里面一开始存储的是外面包裹的函数的ao和go，即存储在[[scope]][0]，然后执行是才会创建自己的ao，查找变量就会按照自身[[scope]]链上去查找值，即作用域链。

## 闭包

是一种现象，内部函数，使用 了外部函数中的变量形成让闭包。